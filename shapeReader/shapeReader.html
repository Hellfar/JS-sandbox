<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>shape shower</title>
		<style>
			.dropzone
			{
				border			: 2px dashed #BBB;
				border-radius	: 5px;
				padding			: 25px;
				text-align		: center;
				color			: #BBB;
			}
		</style>
	</head>
	<body>
		<p id="render" >
			<div id="shapeList" ></div>
			<div class="dropzone" >Drop shapes here</div>
			<output>
			</output>

			<script>
				var	items = {};

				function	parser( a_fileContent, items )
				{
					var		groupName = "untitled",

							len_a_fileContent = a_fileContent.length,
							line;

					for (var i = 0; i < len_a_fileContent; i++)
					{
						if ((line = a_fileContent[i].trim()).length && line[0] != '#')
						{
							var	tokens = line.split(/ /g).filter(function (e){return (e);});

							switch (tokens[0])
							{
								case ('g'):
									groupName = tokens[1];
									items[groupName] = {};
									break;
								default :
									{
										var	fnct = tokens[0];

										if (typeof (items[groupName][fnct]) == "undefined")
											items[groupName][fnct] = [];
										items[groupName][fnct].push(tokens.slice(1));
									}
									break;
							};
						}
					}
				}

				function	handleFileSelect(evt)
				{
					evt.stopPropagation();
					evt.preventDefault();

					document.querySelector("output").appendChild(document.createElement('ul'));

					var files = evt.dataTransfer.files;

					var output = [];
					for (var i = 0, f; f = files[i]; i++)
					{
						var reader = new FileReader();

						reader.onload = (function(file)
						{
							return (function (e)
							{
								var f = e.target;
								var list = document.getElementsByTagName("ul")[0];

								parser(e.target.result.split("\n"), items);
								// draw(items);
								output.push('<li><strong>', escape(file.name), '</strong> (', file.type || 'n/a', ') - ', file.size, ' bytes, last modified: ', file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() : 'n/a', '<pre style="border: 1px solid black;" >', e.target.result.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"), '</pre></li>');
								list.innerHTML = output.join('');
							});
						})(f);

						reader.readAsBinaryString(f);
					}

					if ( evt.target.className == "dropzone" )
					{
						evt.target.style.background = "";
					}
				}
				function	handleDragOver(evt)
				{
					evt.stopPropagation();
					evt.preventDefault();
					evt.dataTransfer.dropEffect = 'copy';
				}
				function	handleDragEnter(evt)
				{
					if ( evt.target.className == "dropzone" )
					{
						evt.target.style.background = "AliceBlue";
					}
				}
				function	handleDragLeave(evt)
				{
					if ( evt.target.className == "dropzone" )
					{
						evt.target.style.background = "";
					}
				}
				var dropZone = document.getElementsByClassName('dropzone')[0];
				dropZone.addEventListener('dragover', handleDragOver, false);
				dropZone.addEventListener('dragenter', handleDragEnter, false);
				dropZone.addEventListener('dragleave', handleDragLeave, false);
				dropZone.addEventListener('drop', handleFileSelect, false);
			</script>
		</p>
	</body>
</html>
